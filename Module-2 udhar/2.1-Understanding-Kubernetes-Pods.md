# 2.1 Understanding Kubernetes Pods - [Link](https://devopscube.com/kubernetes-pod/)

<img src="https://devopscube.com/wp-content/uploads/2023/08/kubernetes-pod.png" width="80%">

`Image Credits: devopscube.com`

- **files -> image -> container -> pod**

- Kubernetes is a container orchestration system for deploying, scaling, and managing containerized applications and it has its own way of running containers.
- **We call it a pod**.

### Definition:

- A **pod** is the smallest deployable unit in Kubernetes that represents a single instance of an application.

##### Q) how does a Pod differ from a container?

- A container is a single unit. However, a pod can contain more than one container.
- You can think of **pods as a box that can hold one or more containers together**.

How? Pod provides a higher level of abstraction than containers.
: Pods can have multiple containers if you manage one pod means you manage multiple containers.

---

### Comunications between Containers inside Pods

- Pod gets a single unique IP address
- containers running inside the pod use **localhost** to connect to each other **on <u>different ports</u>**.

<img src="https://devopscube.com/wp-content/uploads/2023/08/multi-container-pod.gif" width="70%">

`Image Credits: devopscube.com`

#### <u>So, containers inside the pod share these followings</u>:-

- **Network Namespace** – means, containers can communicate with each other using **localhost** or **127.0.0.1**, as if they were on the same host.

- **IPC Namespace (Interprocess Communication)** – means they are allowed for communication between themselves using **System V IPC** and **POSIX** message queues (like, containers WhatsApp).

- **UTS Namespace (UNIX Time-Sharing System)** – means containers will have same hostname and NIS domain name.

### Key Points:

1. **Pods:** Smallest units in Kubernetes.
2. **Short-Lived:** Created, deleted, updated.
3. **Multiple Containers:** No limit per pod.
4. **Unique IP:** Assigned to each pod.
5. **Inter-Pod Communication(between pods):** Uses IP addresses.
6. **Intra-Pod Communication(between containers):** Via localhost on different ports.
7. **Port Clashes:** Avoid by using different port numbers.
8. **Resource Allocation:** Set CPU and memory limits.
9. **Shared Volume:** Containers in a pod share.
10. **Node Placement:** All containers on the same node.
11. **Startup Sequence:** Main containers in parallel, init containers sequentially.

---

##### Q) What is Kubernetes Object?

Answer:
: A Kubernetes object is like a blueprint or set of instructions that you write in (YAML or JSON) that tells Kubernetes how to manage and run a specific part of your application or system.

- You write your **desired state** in the file in the form of instructions.

- Any object you create, gets stored in `etcd`. under the key named `/registry` dir.

Here's a simple example of a Kubernetes Pod object in YAML:

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: example-pod
spec:
  containers:
    - name: nginx-container
      image: nginx:latest
```

This is a basic example, and the structure can vary based on the type of Kubernetes object (e.g., Pod, Service, Deployment) and its specific configuration.

<!-- ## Core Concepts and Components

### Core Concepts:

### Components:

- **Pod Spec**: Describes the desired state of the Pod, including containers, volumes, and other specifications.
- **Pod Status**: Reflects the current state of the Pod, indicating whether it is running, terminated, or initializing.
- **Pod Template**: A blueprint for creating identical Pods, facilitating easier management and scaling. -->

---

Master - rgb(77, 0, 0)

Worker - rgb(19, 3, 99)

---

# Create your first Pod

Step 1:- Create the Manifest file
: - Write the "desired state", and save the YAML manifest file, on **control-plane**. let's say `example-pod.yaml`.

```yml
apiVersion: v1
kind: Pod
metadata:
  name: example-pod
  labels:
    app: example
spec:
  containers:
    - name: container-1
      image: nginx:latest
      ports:
        - containerPort: 80
  restartPolicy: Always
```

Step 2:- Apply the Manifest
: - Navigate to the dir where the YAML file is saved and run the following command:

For first time.

```bash
kubectl create -f <name_of_the_file>.yaml
```

Updating the pod.

```bash
kubectl apply -f pod-definition.yaml
```

Step 3:- Check Pod Status.
: - Wait until the Pod's STATUS becomes **"Running"**.

```bash
kubectl get pods
```

---

#### Verify

Step 4:- Access Nginx
: - To access the Nginx service you will need the IP address of the Pod.
: - Look for the IP address under the **"IP"** column.

```bash
kubectl get pod example-pod -o wide
```

- relpace `example-pod` with your pod name.

Step 5:- Verify Nginx
: - Open a web browser or use tools like curl or wget to access the Nginx service.
: - If everything is set up correctly, you should see the default Nginx welcome page.

```bash
curl <pod_ip>:80
```

---

## Pods YAML explaination

- **apiVersion**: Specifies the API version for the Kubernetes object. For Pods, it's usually v1.
- **kind**: Specifies the type of resource, in this case, it's a Pod.
- **metadata**: Contains metadata about the object, including **name** and optional **labels**.
- **spec**: Describes the **desired state** of the resource.
- **containers**: Specifies an array of containers within the Pod.
- **name**: The name of the container.
- **image**: The Docker image to use.
- **ports**: Specifies ports to open on the container.
- **restartPolicy**: Defines the restart policy for the Pod (Always, OnFailure, or Never), in this case, it means it will **Always** be restarted automatically if they exit for any reason.

---

## Adittional Comands

View Pod Details:
: To get more **details of the running pod** use.,

```bash
kubectl describe pod <pod-name>
```

This command provides comprehensive information about the pod, including events and conditions.

Accessing Pod Logs:
: To view the logs of a container within the pod, use kubectl logs.

```bash
kubectl logs mypod -c mycontainer
```

Replace mypod with your pod's name and mycontainer with your container's name.
